var game,DiamondScope=function(){var n=function(e,i,n,t,s){this.question=e,this.answers=i,this.rightAnswer=n,this.difficulty=t,this.id=s,this.used=!1};n.prototype={getRightAnswer:function(){return this.rightAnswer}};var t=function(e,i){this.id=e,this.name=i,this.questionCount=0,this.joker={fifty:1,audience:1}};t.prototype={useJoker:function(e){return 0==e?0!=this.joker.fifty?(this.joker.fifty=0,game.useFiftyFifty(d.rightAnswer)):[]:1==e?0!=this.joker.audience?(this.joker.audience=0,game.useAudience(d.difficulty,d.rightAnswer)):[]:void 0}};var s=function(e){this.round=0,this.players=[],this.gameMode=void 0,this.ranking={rounds:void 0,points:void 0},this.questions=e,this.questions.forEach(function(e){e.used=!1}),this.questionID=0,this.currentPlayer=0,this.expulsedPlayers=void 0,this.change=!1};s.prototype={addPlayer:function(e){id=this.players.length,this.players.push(new t(id,e))},useFiftyFifty:function(e){var i=[!1,!1,!1,!1];i[e]=!0;for(var n=parseInt(4*Math.random());n==e;)n=parseInt(4*Math.random());return i[n]=!0,i},useAudience:function(e,i){var n;switch(e){case 0:n=0;break;case 1:n=5;break;case 2:n=9;break;case 3:n=13;break;case 4:n=17;break;default:n=0}var t=[];t[0]=parseInt(20*Math.random())+40-n,t[1]=parseInt((100-t[0])/3*(Math.random()+.4)),t[2]=parseInt((100-t[0])/3*(Math.random()+.4)),t[3]=100-t[0]-t[1]-t[2];var s=t[i];return t[i]=t[0],t[0]=s,t},nextPlayer:function(){for(this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0,this.change=!0);this.expulsedPlayers[this.currentPlayer];)this.change=!1,this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0,this.change=!0)}};var d,a=[],o=function(){c(),l(),$.getJSON(SERVER_URL+QUESTION_FILE,function(e){a=e,a.forEach(function(e,i){a[i]=new n(e.question,e.answers,e.rightAnswer,e.difficulty,e.id)}),u()})},l=function(){$(window).resize(function(){c()}),$(window).load(function(){c()}),$(document).on("click","#joker-fifty",function(){$(this).addClass("disabled"),answers=game.players[game.currentPlayer].useJoker(0),answers.forEach(function(e,i){e||(char=0==i?"a":1==i?"b":2==i?"c":"d",$("#answer-"+char).html(""))})}),$(document).on("click","#joker-audience",function(){$(this).addClass("disabled"),answers=game.players[game.currentPlayer].useJoker(1),answers.forEach(function(e,i){char=0==i?"a":1==i?"b":2==i?"c":"d",$("#answer-"+char).html(answers[i]+"%")})}),$(document).on("click",".answer",function(){id=$(this).data("id"),id==d.rightAnswer?($(this).addClass("green"),setTimeout(function(){1==game.gameMode&&game.nextPlayer(),v()},1500)):($(this).addClass("red"),$(".answer").each(function(){$(this).data("id")==d.rightAnswer&&$(this).addClass("yellow")}),setTimeout(function(){h()},1500))})},c=function(){$(window).outerHeight()/9>$(window).outerWidth()/16?($("body > #video-background").css({width:"auto",height:"100%"}),$("#video-background-inner").css({width:"auto",height:"150%"})):($("body > #video-background").css({width:"100%",height:"auto"}),$("#video-background-inner").css({width:"150%",height:"auto"})),$(".vertical-center").each(function(){$(this).css("margin-top",$($(this).attr("data-container")).outerHeight()/2-$(this).outerHeight())}),$(".vertical-center-2").each(function(){$(this).css("margin-top",$($(this).attr("data-container")).outerHeight()/2-$(this).outerHeight()/2)})},u=function(){game=new s(a),f.startMenu()},v=function(){0==game.gameMode?(difficulty=Math.floor(game.round++/3),game.questionID++,f.frage(difficulty)):1==game.gameMode&&(difficulty=Math.floor(game.round/3),game.change&&(game.questionID++,difficulty=Math.floor(game.round++/3),game.change=!1),f.frage(difficulty))},h=function(){0==game.gameMode?f.endView():1==game.gameMode&&(game.expulsedPlayers[game.currentPlayer]=!0,size=function(i){size=0;for(e in i)size++;return size}(game.expulsedPlayers),size==game.players.length?f.endView():(game.nextPlayer(),v()))},f=function(){var e=function(){content='<div class="container-fluid logo-box"><div class="row"><div class="col-md-8 col-centered"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive start-logo" alt="Diamond Scope"></div></div></div><div class="vertical-center container-fluid button-box" data-container="#main-center"><div class="menu-button col-centered rounded-div main-design btn" id="singleplayer-button"><h1>Singleplayer</h1></div><div class="clearfix"></div><div class="menu-button col-centered rounded-div main-design btn" id="multiplayer-button"><h1>Multiplayer</h1></div><div class="clearfix"></div></div>',$("#content-div").html(content),$("#singleplayer-button").on("click",function(){$(this).off("click"),u(n)}),$("#multiplayer-button").on("click",function(){$(this).off("click"),u(t)})},n=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-xs-6 col-centered"><div class="main-design"><h1>Spielername</h1></div></div></div><div class="row"><div class="col-xs-6 col-centered"><div class="main-design"><input type="text" class="main-design names" id="player-name"></div></div></div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),u(e)}),$("#next-button").on("click",function(){$(this).off("click"),game.addPlayer($("#player-name").val()),game.gameMode=0,u(r),setTimeout(function(){v()},501)})},t=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-xs-6 col-centered"><div class="main-design"><h1>Spielernamen</h1></div></div></div><div class="row"><div class="multiplayer-names col-centered relative"><div class="main-design" id="player-names"><input type="text" class="main-design names" id="player-name-1" placeholder="Spieler 1"><input type="text" class="main-design names" id="player-name-2" placeholder="Spieler 2"></div></div>                </div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div><div class="multiplayer-count btn-group" role="group"><div type="button" id="player-2" data-id="2" class="btn rounded-div main-design count selected"><h1>2</h1></div><div type="button" id="player-3" data-id="3" class="btn rounded-div main-design count"><h1>3</h1></div><div type="button" id="player-4" data-id="4" class="btn rounded-div main-design count"><h1>4</h1></div><div type="button" id="player-5" data-id="5" class="btn rounded-div main-design count"><h1>5</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),u(e)}),$(".count").on("click",function(){for($(".count").removeClass("selected"),$(this).addClass("selected"),content="",i=1;i<=$(this).data("id");i++)content+='<input type="text" class="main-design names" id="player-name-'+i+'" placeholder="Spieler '+i+'">';$("#player-names").html(content),c()}),$("#next-button").on("click",function(){$(".names").each(function(){game.addPlayer($(this).val())}),game.gameMode=1,game.questionID++,game.expulsedPlayers={},u(r),setTimeout(function(){v()},501)})},r=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-xs-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div><div class="col-xs-4 pull-right"><div class="main-design" id="current-question"><h3>Frage X</h3></div><div class="main-design" id="player"><h4>Spieler X</h4></div></div></div></div><div class="clearfix"></div><div class="row"><div class="col-xs-12 main-design"><h1 id="question">Wie hei&szlig;t eine g√§ngige Projektmanagement-Methode?</h1></div></div></div><div class="container-fluid answer-box"><div class="container-fluid"><div class="col-md-12 rounded-div main-design answer" data-id="0"><h4 class="pull-left">A</h4><div class="clearfix"></div><h4 id="answer-a">Duke1</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="1"><h4 class="pull-left">B</h4><div class="clearfix"></div><h4 id="answer-b">Prince2</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="2"><h4 class="pull-left">C</h4><div class="clearfix"></div><h4 id="answer-c">King4</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="3"><h4 class="pull-left">D</h4><div class="clearfix"></div><h4 id="answer-d">Queen3</h4></div></div><div class="row"><div class="col-xs-2 pull-right rounded-div joker-button main-design" id="joker-audience"><h4>Publikum</h4></div><div class="col-xs-2 pull-right rounded-div joker-button main-design" id="joker-fifty"><h4>2 Aus 4</h4></div></div></div>',$("#content-div").html(content)},o=function(e){function i(e){return selectedQuestions=$.grep(game.questions,function(i){return i.difficulty==e&&!i.used}),d=selectedQuestions[Math.floor(Math.random()*selectedQuestions.length)],d.used=!0,d}var t,s,a,n=i(e),r=0;for(s=0;4>s;s++)t=Math.floor(Math.random()*(s+1)),t==r&&(n.rightAnswer=s,r=s),a=n.answers[s],n.answers[s]=n.answers[t],n.answers[t]=a;category=" (Kategorie: "+(e+1)+")",player="Spieler "+(game.currentPlayer+1)+" - "+game.players[game.currentPlayer].name,$("#current-question > h3").html("Frage "+game.questionID+category),$("#player > h4").html(player),$("#question").html(n.question),$("#answer-a").html(n.answers[0]),$("#answer-b").html(n.answers[1]),$("#answer-c").html(n.answers[2]),$("#answer-d").html(n.answers[3]),$(".answer").removeClass("red"),$(".answer").removeClass("green"),$(".answer").removeClass("yellow"),$(".joker-button").removeClass("disabled"),0==game.players[game.currentPlayer].joker.audience&&$("#joker-audience").addClass("disabled"),0==game.players[game.currentPlayer].joker.fifty&&$("#joker-fifty").addClass("disabled")},l=function(){game=new s(a),e()},u=function(e){$("#content-div").addClass("fade"),setTimeout(function(){e(),setTimeout(function(){$("#content-div").removeClass("fade")},500),c()},500)};return{startMenu:e,frage:o,endView:l}}();return{init:o}}();$(function(){$(window).load(function(){setTimeout(function(){$("body > #loading").css("opacity","0"),setTimeout(function(){$("body > #loading").remove()},1001)},1500)}),DiamondScope.init()});