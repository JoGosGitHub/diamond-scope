var DiamondScope=function(){var n=function(e,n,i,t,a){this.question=e,this.answers=n,this.rightAnswer=i,this.difficulty=t,this.id=a,this.used=!1,this.scrambledAnswers=[0,1,2,3]};n.prototype={getRightAnswer:function(){return this.rightAnswer}};var t=function(e,n){this.id=e,this.name=n,this.questionCount=0,this.joker={fifty:1,audience:1}};t.prototype={useJoker:function(e){return 0==e?0!=this.joker.fifty?(this.joker.fifty=0,r.useFiftyFifty(d.rightAnswer)):[]:1==e?0!=this.joker.audience?(this.joker.audience=0,r.useAudience(d.difficulty,d.rightAnswer)):0:void 0}};var a=function(e){this.round=0,this.players=[],this.gameMode=void 0,this.ranking={rounds:{},points:{}},this.questions=e,this.questionID=0,this.currentPlayer=0,this.expulsedPlayers=void 0};a.prototype={addPlayer:function(e){id=this.players.length,this.players.push(new t(id,e))},useFiftyFifty:function(e){var n=[!1,!1,!1,!1];n[e]=!0;for(var i=parseInt(4*Math.random());i==e;)i=parseInt(4*Math.random());return n[i]=!0,n},useAudience:function(e,n){var i;switch(e){case 0:i=0;break;case 1:i=5;break;case 2:i=9;break;case 3:i=13;break;case 4:i=17;break;default:i=0}var t=[];t[0]=parseInt(20*Math.random())+40-i,t[1]=parseInt((100-t[0])/3*(Math.random()+.4)),t[2]=parseInt((100-t[0])/3*(Math.random()+.4)),t[3]=100-t[0]-t[1]-t[2];var a=t[n];return t[n]=t[0],t[0]=a,t},nextPlayer:function(){for(this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0);this.expulsedPlayers[this.currentPlayer];)this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0)},conclude:function(){return obj=this,1==obj.gameMode?(obj.players.sort(function(e,n){return n.questionCount-e.questionCount}),void 0==obj.ranking.rounds[obj.players[0].id]&&(r.ranking.rounds[r.players[0].id]=0),obj.ranking.rounds[obj.players[0].id]++,content="<h1>Herzlichen Gl√ºckwunsch "+obj.players[0].name+"</h1>",obj.players.forEach(function(e,n){e.questionCount--,void 0===obj.ranking.points[e.id]&&(obj.ranking.points[e.id]=0),obj.ranking.points[e.id]+=e.questionCount,content+="<h1>"+(n+1)+". "+e.name+" mit "+e.questionCount+" Punkten</h1>",e.questionCount=0,e.joker.audience=1,e.joker.fifty=1})):0==obj.gameMode&&(player=obj.players[0],player.questionCount--,content="<h1>Du hast "+player.questionCount+" von "+QUESTIONS_PER_ROUND+" Fragen richtig beantwortet!</h1>",void 0==obj.ranking.points[0]&&(obj.ranking.points[0]=0),obj.ranking.points[0]+=player.questionCount,player.questionCount=0,player.joker.audience=1,player.joker.fifty=1),content},end:function(){return content="",this.round++,0==r.gameMode?content+="<h1>Du hast "+this.round+" Runden gespielt und dabei "+obj.ranking.points[0]+" Punkte erreicht</h1>":1==r.gameMode&&(obj=this,r.players.sort(function(e,n){obj.ranking.points[n.id]-obj.ranking.points[e.id]}),r.players.forEach(function(e,n){void 0===obj.ranking.rounds[e.id]&&(obj.ranking.rounds[e.id]=0),content+="<h1>"+(n+1)+". "+e.name+" mit "+obj.ranking.points[e.id]+" Punkten und "+obj.ranking.rounds[e.id]+" gewonnenen Runden</h1>"})),content}};var d,r,s=[],o=-1,c=-1,l=function(){u(),$.getJSON(SERVER_URL+QUESTION_FILE,function(e){s=e,s.forEach(function(e,i){s[i]=new n(e.question,e.answers,e.rightAnswer,e.difficulty,e.id)}),f()})},u=function(){$(window).resize(function(){h()}),$(document).on("click","#joker-fifty",function(){$(this).addClass("disabled"),answers=r.players[r.currentPlayer].useJoker(0),answers.forEach(function(e,n){e||(char=0==n?"a":1==n?"b":2==n?"c":"d",$("#answer-"+char).html(""),$("#answer-"+char).parent().addClass("disabled"))})}),$(document).on("click","#joker-audience",function(){$(this).addClass("disabled"),answers=r.players[r.currentPlayer].useJoker(1),0!=answers?$("#audience").html(".audience:after{opacity:1;}.audience{color:transparent;}"):answers=[],answers.forEach(function(e,n){char=0==n?"a":1==n?"b":2==n?"c":"d",$("#audience").append("#tag-"+char+":after{height:"+(30+e)+'%;content:"'+e+'%";}')})}),$(document).on("click",".answer",function(){$(this).hasClass("disabled")||($(".answer").addClass("disabled"),id=$(this).data("id"),$("#main-card").focus(),id==d.rightAnswer?($("audio#event").attr("src","assets/sounds/Frage_Richtig.mp3"),$("audio#event").get(0).play(),$(this).addClass("green"),setTimeout(function(){1==r.gameMode&&r.nextPlayer(),g()},1500)):($("audio#event").attr("src","assets/sounds/Frage_Falsch.mp3"),$("audio#event").get(0).play(),$("audio#background").get(0).pause(),$("audio#voice").get(0).pause(),$(this).addClass("red"),$(".answer").each(function(){$(this).data("id")==d.rightAnswer&&$(this).addClass("yellow")}),setTimeout(function(){m()},1500)))})},v=function(){$(".vertical-center").each(function(){$(this).css("margin-top",$($(this).data("container")).outerHeight()/2-$(this).outerHeight())}),$(".vertical-center-2").each(function(){$(this).css("margin-top",$($(this).data("container")).outerHeight()/2-$(this).outerHeight()/2)})},h=function(){-1==o&&(o=$(window).width()<1200?1400:1e3),$(window).width()<1200&&o>=1200?($("body > .container-fluid").css("height","0"),$("body > #main-center.container-fluid").css({height:"99%"}),$("#main-card").css("margin","0.5%"),$("#video-background, #video-background-inner").attr("src",""),$("#video-background-inner").css({left:"0",top:"0",width:"100%"}),$("body, *").css("font-weight",300)):$(window).width()>=1200&&1200>o&&($("body > .container-fluid").css("height","15%"),$("body > #main-center.container-fluid").css({height:"70%"}),$("#main-card").css("margin","5px"),$("#video-background").attr("src","assets/videos/QuzzeldullBackgroundLoopCompressed.mp4"),$("#video-background-inner").attr("src","assets/videos/QuzzeldullBackgroundLoopBlurCompressed.mp4"),$("#video-background-inner").css({left:"-25%",top:"-25%",width:"150%"}),$("body, *").css("font-weight",100)),o=$(window).width(),$(window).outerHeight()/9>$(window).outerWidth()/16?($("body > #video-background").css({width:"auto",height:"100%"}),$("#video-background-inner").css({width:"auto",height:"150%"})):($("body > #video-background").css({width:"100%",height:"auto"}),$("#video-background-inner").css({width:"150%",height:"auto"})),v()},f=function(){r=new a(s),p.startMenu()},g=function(){difficulty=Math.floor(r.players[r.currentPlayer].questionCount++/3),r.players[r.currentPlayer].questionCount<=QUESTIONS_PER_ROUND?p.frage(difficulty):p.endView()},m=function(){0==r.gameMode?p.endView():1==r.gameMode&&(r.expulsedPlayers[r.currentPlayer]=!0,size=function(n){size=0;for(e in n)size++;return size}(r.expulsedPlayers),size==r.players.length?p.endView():(r.nextPlayer(),g()))},p=function(){var e=function(){content='<div class="container-fluid logo-box"><div class="row"><div class="col-md-8 col-centered"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive start-logo" alt="Diamond Scope"></div></div></div><div class="vertical-center container-fluid button-box" data-container="#main-center"><div class="menu-button col-centered rounded-div main-design btn" id="singleplayer-button"><h1>Singleplayer</h1></div><div class="clearfix"></div><div class="menu-button col-centered rounded-div main-design btn" id="multiplayer-button"><h1>Multiplayer</h1></div><div class="clearfix"></div></div>',$("#content-div").html(content),$("#singleplayer-button").on("click",function(){$(this).off("click"),p(n)}),$("#multiplayer-button").on("click",function(){$(this).off("click"),p(t)}),$("audio#background").removeAttr("loop"),$("audio#background").attr("src","assets/sounds/Start_Musik.mp3"),$("audio#background").get(0).addEventListener("ended",function e(){$("audio#background").attr("src","assets/sounds/Start_Musik_Loop.mp3"),$("audio#background").attr("loop","loop"),$("audio#background").get(0).play(),$("audio#background").get(0).removeEventListener("ended",e)}),$("audio#background").get(0).play()},n=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-lg-6 col-centered"><div class="main-design"><h1>Spielername</h1></div></div></div><div class="row"><div class="col-lg-6 col-centered"><div class="main-design"><input type="text" class="main-design names" id="player-name"></div></div></div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),p(e)}),$("#next-button").on("click",function(){$(this).off("click"),r.addPlayer($("#player-name").val()),r.gameMode=0,p(o),setTimeout(function(){g()},501)})},t=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-lg-6 col-centered"><div class="main-design"><h1>Spielernamen</h1></div></div></div><div class="row"><div class="multiplayer-names col-centered relative"><div class="main-design" id="player-names"><input type="text" class="main-design names" id="player-name-1" placeholder="Spieler 1"><input type="text" class="main-design names" id="player-name-2" placeholder="Spieler 2"></div></div>                </div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div><div class="multiplayer-count btn-group" role="group"><div type="button" id="player-2" data-id="2" class="btn rounded-div main-design count selected"><h1>2</h1></div><div type="button" id="player-3" data-id="3" class="btn rounded-div main-design count"><h1>3</h1></div><div type="button" id="player-4" data-id="4" class="btn rounded-div main-design count"><h1>4</h1></div><div type="button" id="player-5" data-id="5" class="btn rounded-div main-design count"><h1>5</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),p(e)}),$(".count").on("click",function(){for($(".count").removeClass("selected"),$(this).addClass("selected"),content="",i=1;i<=$(this).data("id");i++)content+='<input type="text" class="main-design names" id="player-name-'+i+'" placeholder="Spieler '+i+'">';$("#player-names").html(content),h()}),$("#next-button").on("click",function(){$(".names").each(function(){r.addPlayer($(this).val())}),r.gameMode=1,r.questionID++,r.expulsedPlayers={},p(o),setTimeout(function(){g()},501)})},o=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div><div class="col-lg-4 pull-right"><div class="main-design" id="current-question"><h3>Frage X</h3></div><div class="main-design" id="player"><h4>Spieler X</h4></div></div></div></div><div class="clearfix"></div><div class="row"><div class="col-lg-12 main-design"><h1 id="question">Wie hei&szlig;t eine g√§ngige Projektmanagement-Methode?</h1></div></div></div><div class="container-fluid answer-box"><div class="container-fluid"><div class="col-md-12 rounded-div main-design answer" data-id="0"><h4 id="tag-a" class="pull-left vertical-center-2 audience" data-container=".answer[data-id=0]">A</h4><h4 id="answer-a" class="vertical-center-2" data-container=".answer[data-id=0]">Duke1</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="1"><h4 id="tag-b" class="pull-left vertical-center-2 audience" data-container=".answer[data-id=1]">B</h4><h4 id="answer-b" class="vertical-center-2" data-container=".answer[data-id=1]">Prince2</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="2"><h4 id="tag-c" class="pull-left vertical-center-2 audience" data-container=".answer[data-id=2]">C</h4><h4 id="answer-c" class="vertical-center-2" data-container=".answer[data-id=2]">King4</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="3"><h4 id="tag-d" class="pull-left vertical-center-2 audience" data-container=".answer[data-id=3]">D</h4><h4 id="answer-d" class="vertical-center-2" data-container=".answer[data-id=3]">Queen3</h4></div></div><div class="row"><div class="col-lg-2 pull-right rounded-div joker-button main-design" id="joker-audience"><h4 class="vertical-center-2" data-container="#joker-audience">Publikum</h4></div><div class="col-lg-2 pull-right rounded-div joker-button main-design" id="joker-fifty"><h4 class="vertical-center-2" data-container="#joker-fifty">50:50</h4></div></div></div>',$("#content-div").html(content)},l=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div></div></div></div><div class="vertical-center-2" data-container="#main-center"><div class="row"><div class="col-lg-12 main-design">',content+=r.conclude(),content+='</div></div><div class="menu-button rounded-div main-design btn" id="new-game-button"><h1>Neue Runde</h1></div><div class="menu-button rounded-div main-design btn" id="report-button"><h1>Zur Auswertung</h1></div></div></div>',$("#content-div").html(content),$("#new-game-button").on("click",function(){r.round++<ROUND_LIMIT?(r.questions.forEach(function(e){e.used=!1}),r.expulsedPlayers={},p(o),setTimeout(function(){g()},501)):($(this).html("<h1>Es ist leider nicht m√∂glich mehr als "+ROUND_LIMIT+" Runden zu spielen</h1>"),$(this).off("click"))}),$("#report-button").on("click",function(){u()})},u=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div></div></div></div><div class="vertical-center-2" data-container="#main-center"><div class="row"><div class="col-lg-12 main-design">',content+=r.end(),content+='</div></div><div class="menu-button rounded-div main-design btn" id="menu-button"><h1>Zum Hauptmenu</h1></div></div></div>',$("#content-div").html(content),$("#menu-button").on("click",function(){r=new a(s),e()})},f=function(e){function n(e){return selectedQuestions=$.grep(r.questions,function(n){return n.difficulty==e&&0==n.used}),d=selectedQuestions[Math.floor(Math.random()*selectedQuestions.length)],d.used=!0,d}var t,a,s,i=n(e),o=i.rightAnswer;for(a=0;4>a;a++)t=Math.floor(Math.random()*(a+1)),t==o?(i.rightAnswer=a,o=a):a==o&&(i.rightAnswer=t,o=t),s=i.answers[a],i.answers[a]=i.answers[t],i.answers[t]=s,s=i.scrambledAnswers[a],i.scrambledAnswers[a]=i.scrambledAnswers[t],i.scrambledAnswers[t]=s;category=" (Kategorie: "+(e+1)+")",player="Spieler "+(r.players[r.currentPlayer].id+1)+" - "+r.players[r.currentPlayer].name,$("#current-question > h3").html("Frage "+r.players[r.currentPlayer].questionCount+category),$("#player > h4").html(player),$("#question").html(i.question),$("#answer-a").html(i.answers[0]),$("#answer-b").html(i.answers[1]),$("#answer-c").html(i.answers[2]),$("#answer-d").html(i.answers[3]),$(".answer").removeClass("red"),$(".answer").removeClass("green"),$(".answer").removeClass("yellow"),$(".answer").removeClass("disabled"),$(".joker-button").removeClass("disabled"),0==r.players[r.currentPlayer].joker.audience&&$("#joker-audience").addClass("disabled"),0==r.players[r.currentPlayer].joker.fifty&&$("#joker-fifty").addClass("disabled"),$("#audience").html(".audience:after{opacity:0;}.audience{opacity:1;}"),v();var l=function(){var e=$("audio#voice").get(0),n=$("audio#voice"),t="assets/voices/voice",a=".mp3";n.attr("src",t+i.id+"-q"+a),e.addEventListener("ended",function s(){n.attr("src",t+"-answer-a"+a),e.removeEventListener("ended",s),e.addEventListener("ended",function d(){n.attr("src",t+i.id+"-"+i.scrambledAnswers[0]+a),e.removeEventListener("ended",d),e.addEventListener("ended",function s(){n.attr("src",t+"-answer-b"+a),e.removeEventListener("ended",s),e.addEventListener("ended",function d(){n.attr("src",t+i.id+"-"+i.scrambledAnswers[1]+a),e.removeEventListener("ended",d),e.addEventListener("ended",function s(){n.attr("src",t+"-answer-c"+a),e.removeEventListener("ended",s),e.addEventListener("ended",function d(){n.attr("src",t+i.id+"-"+i.scrambledAnswers[2]+a),e.removeEventListener("ended",d),e.addEventListener("ended",function s(){n.attr("src",t+"-answer-d"+a),e.removeEventListener("ended",s),e.addEventListener("ended",function d(){n.attr("src",t+i.id+"-"+i.scrambledAnswers[3]+a),e.removeEventListener("ended",d),e.addEventListener("ended",function s(){e.pause(),e.removeEventListener("ended",s)}),e.play()}),e.play()}),e.play()}),e.play()}),e.play()}),e.play()}),e.play()}),e.play()}),e.play()};2>e?(e!=c&&($("audio#background").attr("src","assets/sounds/Frage_Stufe_"+(e+1)+".mp3"),$("audio#background").attr("loop","loop"),$("audio#background").get(0).play()),l()):($("audio#background").removeAttr("loop"),$("audio#background").attr("src","assets/sounds/Frage_Income.mp3"),$("audio#background").get(0).addEventListener("ended",function u(){l(),$("audio#background").attr("src","assets/sounds/Frage_Stufe_"+(e+1)+".mp3"),$("audio#background").attr("loop","loop"),$("audio#background").get(0).play(),$("audio#background").get(0).removeEventListener("ended",u)}),$("audio#background").get(0).play()),c=e},m=function(){p(l)},p=function(e){$("#content-div").addClass("fade"),setTimeout(function(){e(),setTimeout(function(){$("#content-div").removeClass("fade"),v()},500),h()},500)};return{startMenu:e,frage:f,endView:m}}();return{init:l,sizeCheck:h}}();$(function(){$(window).load(function(){$("body, *").css("font-weight",100),DiamondScope.sizeCheck(),$("audio#background").get(0).volume=.05,$("audio#event").get(0).volume=.2,setTimeout(function(){$("body > #loading").css("opacity","0"),setTimeout(function(){$("body > #loading").remove()},1001)},1500)}),DiamondScope.init()});