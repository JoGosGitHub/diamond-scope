$(window).load(function(){setTimeout(function(){$("body > #loading").css("opacity","0")},1500)});var game,DiamondScope=function(){var e=function(e,n,t,o,i){this.question=e,this.answers=n,this.rightAnswer=t,this.difficulty=o,this.id=i};e.prototype={getRightAnswer:function(){return this.rightAnswer}};var n=function(e,n){this.id=e,this.name=n,this.questionCount=0,this.joker={fifty:1,audience:1}};n.prototype={useJoker:function(e){return 1==e?0!=this.joker.fifty?(this.joker.fifty=0,game.useFiftyFifty(i.rightAnswer)):[]:2==e&&0!=this.joker.audience?(this.joker.audience=0,game.useAudience(i.difficulty,i.rightAnswer)):void 0}};var t=function(e){this.round=0,this.players=[],this.ranking={rounds:void 0,points:void 0},this.questions=e};t.prototype={addPlayer:function(e){id=this.players.length,this.players.push(new n(id,e))},useFiftyFifty:function(e){var n=[!1,!1,!1,!1];n[e]=!0;for(var t=parseInt(4*Math.random());t==e;)t=parseInt(4*Math.random());return n[t]=!0,n},useAudience:function(e,n){var t;switch(e){case 0:t=0;break;case 1:t=5;break;case 2:t=9;break;case 3:t=13;break;case 4:t=17;break;default:t=0}var o=[];o[0]=parseInt(20*Math.random())+40-t,o[1]=parseInt((100-o[0])/3*(Math.random()+.4)),o[2]=parseInt((100-o[0])/3*(Math.random()+.4)),o[3]=100-o[0]-o[1]-o[2];var i=o[n];return o[n]=o[0],o[0]=i,o}};var i,o=[],s=function(){l(),r(),$.getJSON(SERVER_URL+QUESTION_FILE,function(n){o=n,o.forEach(function(n,t){o[t]=new e(n.question,n.answers,n.rightAnswer,n.difficulty,n.id)}),c()})},r=function(){$(window).resize(function(){l()}),$(document).on("click","#joker-fifty",function(){answers=game.useFiftyFifty(i.rightAnswer),answers.forEach(function(e,n){e||(char=0==n?"a":1==n?"b":2==n?"c":"d",$("#answer-"+char).html(""))})}),$(document).on("click","#joker-audience",function(){answers=game.useAudience(h(game.round),i.rightAnswer),answers.forEach(function(e,n){char=0==n?"a":1==n?"b":2==n?"c":"d",$("#answer-"+char).html(answers[n]+"%")})}),$(document).on("click",".answer",function(){id=$(this).data("id"),difficulty=h(game.round++),id==i.rightAnswer?($(this).addClass("green"),setTimeout(function(){d(difficulty)},1500)):($(this).addClass("red"),$(".answer").each(function(){$(this).data("id")==i.rightAnswer&&$(this).addClass("yellow")}),setTimeout(function(){d(difficulty)},1500))})},l=function(){$(window).outerHeight()/9>$(window).outerWidth()/16?($("body > #video-background").css({width:"auto",height:"100%"}),$("#video-background-inner").css({width:"auto",height:"150%"})):($("body > #video-background").css({width:"100%",height:"auto"}),$("#video-background-inner").css({width:"150%",height:"auto"}))},c=function(){game=new t(o),d(0)},u=function(e){return selectedQuestions=$.grep(game.questions,function(n){return n.difficulty==e}),i=selectedQuestions[Math.floor(Math.random()*selectedQuestions.length)],i.difficulty=-1,i},h=function(e){return Math.floor(e/3)},d=function(e){var t,o,i,n=u(e),a=0;for(o=0;4>o;o++)t=Math.floor(Math.random()*(o+1)),t==a&&(n.rightAnswer=o,a=o),i=n.answers[o],n.answers[o]=n.answers[t],n.answers[t]=i;var s=" (Kategorie: "+(e+1)+")";$("#current-question > h3").html("Frage "+n.id+s),$("#question").html(n.question),$("#answer-a").html(n.answers[0]),$("#answer-b").html(n.answers[1]),$("#answer-c").html(n.answers[2]),$("#answer-d").html(n.answers[3]),$(".answer").removeClass("red"),$(".answer").removeClass("green"),$(".answer").removeClass("yellow")};return{init:s}}();$(function(){DiamondScope.init()});